# 单图单人脸检测

## 简介

本项目旨在探索一种轻量化的 **单图单人脸检测方法**。  
模型面向嵌入式部署，采用 **深度可分离卷积** 和 **简易瓶颈结构** 作为骨干网络，并通过 **YOLO 风格回归头** 进行边框预测。

该模型的目标并非超越大型检测器，而是提供一个 **可在 MCU 上实时运行的人脸检测方案**。

## 特性

- 输入尺寸：**60 × 80 像素**  
- 输出通道：**33**  
  - 通道 1：置信度（使用 **Focal Loss** 训练）  
  - 通道 2–33：4×8 网格对应的边框距离格子中心的上下左右长度（归一化）  
- 轻量高效  
- 面向嵌入式，优化 RA8D1 MCU  
- 推理速度约 8–10 毫秒/帧  
- 支持量化  

## 数据集

- 训练集采用 **LabelMe** 标注格式  
- **必须**：每个标注 JSON 文件 **必须包含原图**  
- 若要训练自己的数据集，需要修改 `dataset` 文件夹里的相关文件  

## 训练说明

- 一些超参数可在 `train.py` 脚本中修改  
- `spsf_quant` 用于量化操作，可根据需求调整  
- 训练脚本要求 JSON 文件同时包含标注和原图  

## 部署说明

- 项目提供经过 **瑞萨 eAI 工具** 生成的 **C 文件** 模型代码  
- 推理使用 **ARM CMSIS-NN** 加速  
- RA8D1 上单帧推理约 8–10 毫秒  
- 预测解码过程可参考提供的 Python 代码或 C 文件  

## 限制

- 对于非常大的脸，效果可能不佳  

## 备注

- 本项目处于学习阶段，旨在进行实验和嵌入式部署实践。
